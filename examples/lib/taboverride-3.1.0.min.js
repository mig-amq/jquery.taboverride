/*! taboverride v3.1.0 | https://github.com/wjbryant/taboverride
Copyright (c) 2012 Bill Bryant | http://opensource.org/licenses/mit */
(function(e){"use strict";function t(){var t=window.TABOVERRIDE=e();return t}typeof define=="function"&&define.amd?define("taboverride",[],t):t()})(function(){"use strict";var e={},t=window.document,n,r,i="	",s=!1,o=!1,u=t.createElement("textarea"),a,f;return e.overrideKeyDown=function(e){e=e||event;var n=e.currentTarget||e.srcElement,r=e.keyCode,u,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k="character";if(n.nodeName&&n.nodeName.toLowerCase()!=="textarea"||r!==9&&(r!==13||!s)||e.ctrlKey||e.altKey)return;o=!1,c=n.value,m=n.scrollTop;if(typeof n.selectionStart=="number")g=n.selectionStart,y=n.selectionEnd,b=c.slice(g,y);else{if(!t.selection)return;h=t.selection.createRange(),b=h.text,p=h.duplicate(),p.moveToElementText(n),p.setEndPoint("EndToEnd",h),y=p.text.length,g=y-b.length,f>1?(d=c.slice(0,g).split(a).length-1,v=b.split(a).length-1):d=v=0}if(r===9)u=i,l=u.length,S=0,x=0,T=0,g!==y&&b.indexOf("\n")!==-1?(g===0||c.charAt(g-1)==="\n"?w=g:w=c.lastIndexOf("\n",g-1)+1,y===c.length||c.charAt(y)==="\n"?E=y:(E=c.indexOf("\n",y),E===-1&&(E=c.length)),e.shiftKey?(c.slice(w).indexOf(u)===0&&(w===g?b=b.slice(l):T=l,x=l),n.value=c.slice(0,w)+c.slice(w+T,g)+b.replace(new RegExp("\n"+u,"g"),function(){return S+=1,"\n"})+c.slice(y),h?(h.collapse(),h.moveEnd(k,y-x-S*l-v-d),h.moveStart(k,g-T-d),h.select()):(n.selectionStart=g-T,n.selectionEnd=y-x-S*l)):(S=1,n.value=c.slice(0,w)+u+c.slice(w,g)+b.replace(/\n/g,function(){return S+=1,"\n"+u})+c.slice(y),h?(h.collapse(),h.moveEnd(k,y+S*l-v-d),h.moveStart(k,g+l-d),h.select()):(n.selectionStart=g+l,n.selectionEnd=y+S*l,n.scrollTop=m))):e.shiftKey?c.slice(g-l).indexOf(u)===0&&(n.value=c.slice(0,g-l)+c.slice(g),h?(h.move(k,g-l-d),h.select()):(n.selectionEnd=n.selectionStart=g-l,n.scrollTop=m)):h?(h.text=u,h.select()):(n.value=c.slice(0,g)+u+c.slice(y),n.selectionEnd=n.selectionStart=g+l,n.scrollTop=m);else if(s){if(g===0||c.charAt(g-1)==="\n"){o=!0;return}w=c.lastIndexOf("\n",g-1)+1,E=c.indexOf("\n",g),E===-1&&(E=c.length),N=c.slice(w,E).match(/^[ \t]*/)[0],C=N.length;if(g<w+C){o=!0;return}h?(h.text="\n"+N,h.select()):(n.value=c.slice(0,g)+"\n"+N+c.slice(y),n.selectionEnd=n.selectionStart=g+f+C,n.scrollTop=m)}if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()},e.overrideKeyPress=function(e){e=e||event;var t=e.keyCode;if((t===9||t===13&&s&&!o)&&!e.ctrlKey&&!e.altKey){if(!e.preventDefault)return e.returnValue=!1,!1;e.preventDefault()}},t.addEventListener?(n=function(t){r(t),t.addEventListener("keydown",e.overrideKeyDown,!1),t.addEventListener("keypress",e.overrideKeyPress,!1)},r=function(t){t.removeEventListener("keydown",e.overrideKeyDown,!1),t.removeEventListener("keypress",e.overrideKeyPress,!1)}):t.attachEvent?(n=function(t){r(t),t.attachEvent("onkeydown",e.overrideKeyDown),t.attachEvent("onkeypress",e.overrideKeyPress)},r=function(t){t.detachEvent("onkeydown",e.overrideKeyDown),t.detachEvent("onkeypress",e.overrideKeyPress)}):n=r=function(){},e.set=function(e,t){var i,s,o,u,a;if(e){i=arguments.length<2||t?n:r,u=e,o=u.length,typeof o!="number"&&(u=[u],o=1);for(s=0;s<o;s+=1)a=u[s],a&&a.nodeName&&a.nodeName.toLowerCase()==="textarea"&&i(a)}return this},e.tabSize=function(e){var t;if(arguments.length){if(!e)i="	";else if(typeof e=="number"&&e>0){i="";for(t=0;t<e;t+=1)i+=" "}return this}return i==="	"?0:i.length},e.autoIndent=function(e){return arguments.length?(s=e?!0:!1,this):s},u.value="\n",a=u.value,f=a.length,u=null,e});
